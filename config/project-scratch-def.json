```json
{
  "corrected_code": "<?php\n\nnamespace Midia\\Repository;\n\nuse Midia\\Entity\\Midia;\nuse Midia\\Exception\\RepositoryException;\nuse PDO;\nuse PDOException;\n\nclass MidiaRepository\n{\n    private PDO $pdo;\n\n    public function __construct(PDO $pdo)\n    {\n        $this->pdo = $pdo;\n    }\n\n    /**\n     * Cria uma nova mídia no banco de dados\n     * \n     * @param Midia $midia\n     * @return Midia\n     * @throws RepositoryException\n     */\n    public function create(Midia $midia): Midia\n    {\n        try {\n            $sql = \"INSERT INTO midias (titulo, tipo, caminho_arquivo, descricao, tamanho_bytes, duracao_segundos, criado_em) \n                    VALUES (:titulo, :tipo, :caminho_arquivo, :descricao, :tamanho_bytes, :duracao_segundos, NOW())\";\n            \n            $stmt = $this->pdo->prepare($sql);\n            $stmt->execute([\n                ':titulo' => $midia->getTitulo(),\n                ':tipo' => $midia->getTipo(),\n                ':caminho_arquivo' => $midia->getCaminhoArquivo(),\n                ':descricao' => $midia->getDescricao(),\n                ':tamanho_bytes' => $midia->getTamanhoBytes(),\n                ':duracao_segundos' => $midia->getDuracaoSegundos()\n            ]);\n            \n            $midia->setId((int)$this->pdo->lastInsertId());\n            return $midia;\n            \n        } catch (PDOException $e) {\n            throw new RepositoryException(\"Erro ao criar mídia: \" . $e->getMessage(), 0, $e);\n        }\n    }\n\n    /**\n     * Busca uma mídia por ID\n     * \n     * @param int $id\n     * @return Midia|null\n     * @throws RepositoryException\n     */\n    public function findById(int $id): ?Midia\n    {\n        try {\n            $sql = \"SELECT * FROM midias WHERE id = :id AND deletado_em IS NULL\";\n            $stmt = $this->pdo->prepare($sql);\n            $stmt->execute([':id' => $id]);\n            \n            $row = $stmt->fetch(PDO::FETCH_ASSOC);\n            \n            if (!$row) {\n                return null;\n            }\n            \n            return $this->hydrate($row);\n            \n        } catch (PDOException $e) {\n            throw new RepositoryException(\"Erro ao buscar mídia: \" . $e->getMessage(), 0, $e);\n        }\n    }\n\n    /**\n     * Lista todas as mídias\n     * \n     * @param int $limit\n     * @param int $offset\n     * @return array\n     * @throws RepositoryException\n     */\n    public function findAll(int $limit = 100, int $offset = 0): array\n    {\n        try {\n            $sql = \"SELECT * FROM midias WHERE deletado_em IS NULL ORDER BY criado_em DESC LIMIT :limit OFFSET :offset\";\n            $stmt = $this->pdo->prepare($sql);\n            $stmt->bindValue(':limit', $limit, PDO::PARAM_INT);\n            $stmt->bindValue(':offset', $offset, PDO::PARAM_INT);\n            $stmt->execute();\n            \n            $midias = [];\n            while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) {\n                $midias[] = $this->hydrate($row);\n            }\n            \n            return $midias;\n            \n        } catch (PDOException $e) {\n            throw new RepositoryException(\"Erro ao listar mídias: \" . $e->getMessage(), 0, $e);\n        }\n    }\n\n    /**\n     * Busca mídias por tipo\n     * \n     * @param string $tipo\n     * @return array\n     * @throws RepositoryException\n     */\n    public function findByTipo(string $tipo): array\n    {\n        try {\n            $sql = \"SELECT * FROM midias WHERE tipo = :tipo AND deletado_em IS NULL ORDER BY criado_em DESC\";\n            $stmt = $this->pdo->prepare($sql);\n            $stmt->execute([':tipo' => $tipo]);\n            \n            $midias = [];\n            while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) {\n                $midias[] = $this->hydrate($row);\n            }\n            \n            return $midias;\n            \n        } catch (PDOException $e) {\n            throw new RepositoryException(\"Erro ao buscar mídias por tipo: \" . $e->getMessage(), 0, $e);\n        }\n    }\n\n    /**\n     * Atualiza uma mídia existente\n     * \n     * @param Midia $midia\n     * @return bool\n     * @throws RepositoryException\n     */\n    public function update(Midia $midia): bool\n    {\n        try {\n            $sql = \"UPDATE midias \n                    SET titulo = :titulo, \n                        tipo = :tipo, \n                        caminho_arquivo = :caminho_arquivo, \n                        descricao = :descricao, \n                        tamanho_bytes = :tamanho_bytes, \n                        duracao_segundos = :duracao_segundos,\n                        atualizado_em = NOW()\n                    WHERE id = :id AND deletado_em IS NULL\";\n            \n            $stmt = $this->pdo->prepare($sql);\n            return $stmt->execute([\n                ':id' => $midia->getId(),\n                ':titulo' => $midia->getTitulo(),\n                ':tipo' => $midia->getTipo(),\n                ':caminho_arquivo' => $midia->getCaminhoArquivo(),\n                ':descricao' => $midia->getDescricao(),\n                ':tamanho_bytes' => $midia->getTamanhoBytes(),\n                ':duracao_segundos' => $midia->getDuracaoSegundos()\n            ]);\n            \n        } catch (PDOException $e) {\n            throw new RepositoryException(\"Erro ao atualizar mídia: \" . $e->getMessage(), 0, $e);\n        }\n    }\n\n    /**\n     * Remove uma mídia (soft delete)\n     * \n     * @param int $id\n     * @return bool\n     * @throws RepositoryException\n     */\n    public function delete(int $id): bool\n    {\n        try {\n            $sql = \"UPDATE midias SET deletado_em = NOW() WHERE id = :id\";\n            $stmt = $this->pdo->prepare($sql);\n            return $stmt->execute([':id' => $id]);\n            \n        } catch (PDOException $e) {\n            throw new RepositoryException(\"Erro ao deletar mídia: \" . $e->getMessage(), 0, $e);\n        }\n    }\n\n    /**\n     * Hidrata um array em objeto Midia\n     * \n     * @param array $row\n     * @return Midia\n     */\n    private function hydrate(array $row): Midia\n    {\n        $midia = new Midia(\n            $row['titulo'],\n            $row['tipo'],\n            $